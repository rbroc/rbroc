---
title: "Bidirectional transformers for context-aware text encoding"
description: "My first DL engineering project (and the project I am currently most excited about!) focuses on training transformer encoders whose representations incorporate information about higher-order context, i.e., characteristics of the author and of the pragmatic context. We feed models a number of text sequences (a target sequence + contexts, i.e., text from either the same author, or from the same subreddit), and train models on a variant of MLM where the MLM head is fed a combination (via sum, concatenation, or attention) between an aggregate representation of the contexts with token-level representations from the target sequence. \n  \n
We experiment with three DistilBERT-inspired architectures: a bi-encoder (where context and target are fed to two separate encoders), a 'batch' encoder (single encoder with added context aggregation and target-context combination layers) and a hierarchical encoder (applying attention across [CLS] tokens in between standard transformer layers to integrate information across contexts and target sequence). The benefits of this training protocol are evaluated both by comparing their MLM performance with traditional MLM training and to a random-context training, and on a triplet-loss author discrimination task.  \n
We also experiment with selective masking of attention heads based on the type of context provided to simultaneously produce separable context representations.  \n  \n The importance of this project is two-fold. First, this way of tuning models to produce context-aware representations may provide intrinsic advantages in NLP tasks, without substantial gains in model complexity. Secondly, text-based representations of text authors could be used to predict individual traits, following the intuition that linguistic behavior is systematically influenced by e.g., personality, experiences, etc.  \n  \n
This project is still in progress, and it has so far been a great source of learning and motivation to pursue an NLP career. I built a large-scale Reddit dataset from scratch, a 'big data' experience that gained me proficiency in SQL. I have become increasingly proficient in Tensorflow for both model engineering, distributed training, and efficient data pipelines. Needless to say, being a self-taught DL engineer, I have made all possible rookie mistakes in the process and have greatly benefitted from each of them.  \n  \n
The project started as a collaboration with Tal Yarkoni, but I have been entirely responsible for implementation throughout and for its evolution in the last months. The project would thus greatly benefit from additional expertise, so please do ping me! if it sounds interesting and you'd be willing to chip in. I am currently training models on our 4 8Gb GPUs, which limits speed (and model sizes), but I am hoping to write up a results report either in preprint or as a conference submission in the coming months.  \n
Code is publicly available here: https://github.com/rbroc/personality_reddit. Planning on making everything nice and tidy once write-up is close, and to share the dataset for public use."
repo: "personality_reddit"
tags: ["NLP", "transformers", "DistilBERT", "TensorFlow", "huggingface", "ML"]
weight: 2
draft: false
---
